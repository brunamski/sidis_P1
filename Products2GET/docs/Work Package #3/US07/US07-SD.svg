<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="529px" preserveAspectRatio="none" style="width:1162px;height:529px;background:#FFFFFF;" version="1.1" viewBox="0 0 1162 529" width="1162px" zoomAndPan="magnify"><defs><filter height="300%" id="f3x28lhms0jry" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f3x28lhms0jry)" height="335.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="85" y="99.6094"/><rect fill="#FFFFFF" filter="url(#f3x28lhms0jry)" height="297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="268" y="121.9609"/><rect fill="#FFFFFF" filter="url(#f3x28lhms0jry)" height="282.6484" style="stroke:#A80036;stroke-width:1.0;" width="10" x="479" y="152.3125"/><rect fill="#FFFFFF" filter="url(#f3x28lhms0jry)" height="119.8906" style="stroke:#A80036;stroke-width:1.0;" width="10" x="640" y="268.7188"/><rect fill="#FFFFFF" filter="url(#f3x28lhms0jry)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="803.5" y="182.6641"/><rect fill="#FFFFFF" filter="url(#f3x28lhms0jry)" height="36.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="969.5" y="299.0703"/><rect fill="#FFFFFF" filter="url(#f3x28lhms0jry)" height="198.9453" style="stroke:#000000;stroke-width:2.0;" width="1110.5" x="10" y="228.0156"/><rect fill="#FFFFFF" height="76.5391" style="stroke:none;stroke-width:1.0;" width="1110.5" x="10" y="350.4219"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="90" x2="90" y1="89.6094" y2="443.9609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="272.5" x2="272.5" y1="89.6094" y2="443.9609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="483.5" x2="483.5" y1="89.6094" y2="443.9609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="644.5" x2="644.5" y1="89.6094" y2="443.9609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="808.5" x2="808.5" y1="89.6094" y2="443.9609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="974.5" x2="974.5" y1="89.6094" y2="443.9609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1120" x2="1120" y1="89.6094" y2="443.9609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="20" y="86.5332">Registered Customer</text><ellipse cx="90" cy="15" fill="#FEFECE" filter="url(#f3x28lhms0jry)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M90,23 L90,50 M77,31 L103,31 M90,50 L77,65 M90,50 L103,65 " fill="none" filter="url(#f3x28lhms0jry)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="20" y="457.4941">Registered Customer</text><ellipse cx="90" cy="470.5703" fill="#FEFECE" filter="url(#f3x28lhms0jry)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M90,478.5703 L90,505.5703 M77,486.5703 L103,486.5703 M90,505.5703 L77,520.5703 M90,505.5703 L103,520.5703 " fill="none" filter="url(#f3x28lhms0jry)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f3x28lhms0jry)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="125" x="208.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="215.5" y="74.5332">:ReviewController</text><rect fill="#FEFECE" filter="url(#f3x28lhms0jry)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="125" x="208.5" y="442.9609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="215.5" y="464.4941">:ReviewController</text><rect fill="#FEFECE" filter="url(#f3x28lhms0jry)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="139" x="412.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="419.5" y="74.5332">service:VoteService</text><rect fill="#FEFECE" filter="url(#f3x28lhms0jry)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="139" x="412.5" y="442.9609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="419.5" y="464.4941">service:VoteService</text><rect fill="#FEFECE" filter="url(#f3x28lhms0jry)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="155" x="565.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="572.5" y="74.5332">service:ReviewService</text><rect fill="#FEFECE" filter="url(#f3x28lhms0jry)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="155" x="565.5" y="442.9609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="572.5" y="464.4941">service:ReviewService</text><rect fill="#FEFECE" filter="url(#f3x28lhms0jry)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="144" x="734.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="741.5" y="74.5332">repo:VoteRepository</text><rect fill="#FEFECE" filter="url(#f3x28lhms0jry)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="144" x="734.5" y="442.9609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="741.5" y="464.4941">repo:VoteRepository</text><rect fill="#FEFECE" filter="url(#f3x28lhms0jry)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="160" x="892.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="899.5" y="74.5332">repo:ReviewRepository</text><rect fill="#FEFECE" filter="url(#f3x28lhms0jry)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="160" x="892.5" y="442.9609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="899.5" y="464.4941">repo:ReviewRepository</text><rect fill="#FEFECE" filter="url(#f3x28lhms0jry)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="59" x="1089" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="1096" y="74.5332">Review</text><rect fill="#FEFECE" filter="url(#f3x28lhms0jry)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="59" x="1089" y="442.9609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="1096" y="464.4941">Review</text><rect fill="#FFFFFF" filter="url(#f3x28lhms0jry)" height="335.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="85" y="99.6094"/><rect fill="#FFFFFF" filter="url(#f3x28lhms0jry)" height="297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="268" y="121.9609"/><rect fill="#FFFFFF" filter="url(#f3x28lhms0jry)" height="282.6484" style="stroke:#A80036;stroke-width:1.0;" width="10" x="479" y="152.3125"/><rect fill="#FFFFFF" filter="url(#f3x28lhms0jry)" height="119.8906" style="stroke:#A80036;stroke-width:1.0;" width="10" x="640" y="268.7188"/><rect fill="#FFFFFF" filter="url(#f3x28lhms0jry)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="803.5" y="182.6641"/><rect fill="#FFFFFF" filter="url(#f3x28lhms0jry)" height="36.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="969.5" y="299.0703"/><polygon fill="#A80036" points="256,117.9609,266,121.9609,256,125.9609,260,121.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="95" x2="262" y1="121.9609" y2="121.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="102" y="117.1045">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="113" y="117.1045">asks to delete a review</text><polygon fill="#A80036" points="467,148.3125,477,152.3125,467,156.3125,471,152.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="278" x2="473" y1="152.3125" y2="152.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="285" y="147.4561">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="296" y="147.4561">getVotesByReviewId(reviewId)</text><polygon fill="#A80036" points="791.5,178.6641,801.5,182.6641,791.5,186.6641,795.5,182.6641" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="489" x2="797.5" y1="182.6641" y2="182.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="496" y="177.8076">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="507" y="177.8076">getVotesByReviewId(reviewId)</text><polygon fill="#A80036" points="289,209.0156,279,213.0156,289,217.0156,285,213.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="283" x2="807.5" y1="213.0156" y2="213.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="295" y="208.1592">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="306" y="208.1592">number of votes</text><path d="M10,228.0156 L71,228.0156 L71,236.0156 L61,246.0156 L10,246.0156 L10,228.0156 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="198.9453" style="stroke:#000000;stroke-width:2.0;" width="1110.5" x="10" y="228.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="242.5107">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="66" x="86" y="241.4346">[if no votes]</text><polygon fill="#A80036" points="628,264.7188,638,268.7188,628,272.7188,632,268.7188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="278" x2="634" y1="268.7188" y2="268.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="285" y="263.8623">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="296" y="263.8623">withdrawReview()</text><polygon fill="#A80036" points="957.5,295.0703,967.5,299.0703,957.5,303.0703,961.5,299.0703" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="650" x2="963.5" y1="299.0703" y2="299.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="657" y="294.2139">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="668" y="294.2139">deleteById(reviewId)</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="979.5" x2="1021.5" y1="334.4219" y2="334.4219"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1021.5" x2="1021.5" y1="334.4219" y2="347.4219"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="974.5" x2="1021.5" y1="347.4219" y2="347.4219"/><polygon fill="#A80036" points="984.5,343.4219,974.5,347.4219,984.5,351.4219,980.5,347.4219" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="986.5" y="329.5654">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="997.5" y="329.5654">deleteByIdIfMatch()</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1120.5" y1="351.4219" y2="351.4219"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="92" x="15" y="362.8408">[if there's votes]</text><polygon fill="#A80036" points="289,384.6094,279,388.6094,289,392.6094,285,388.6094" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="283" x2="644" y1="388.6094" y2="388.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="295" y="383.7529">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="306" y="383.7529">ResponseStatusException()</text><polygon fill="#A80036" points="106,414.9609,96,418.9609,106,422.9609,102,418.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="100" x2="272" y1="418.9609" y2="418.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="112" y="414.1045">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="123" y="414.1045">Informs operation invalid</text><!--MD5=[a6c70f00716fab1af9bbaf970cdf18e1]
@startuml
'https://plantuml.com/sequence-diagram

autoactivate on
autonumber

actor "Registered Customer" as User
participant ":ReviewController" as Ctrl
participant "service:VoteService" as Service2
participant "service:ReviewService" as Service
participant "repo:VoteRepository" as Repo2
participant "repo:ReviewRepository" as Repo
participant "Review" as Review


activate User

User -> Ctrl: asks to delete a review
Ctrl -> Service2: getVotesByReviewId(reviewId)
Service2 -> Repo2: getVotesByReviewId(reviewId)
Repo2 - -> Ctrl: number of votes
alt if no votes
Ctrl -> Service: withdrawReview()
Service -> Repo: deleteById(reviewId)
Repo - -> Repo: deleteByIdIfMatch()
else if there's votes
Service - -> Ctrl: ResponseStatusException()
Ctrl - -> User: Informs operation invalid
end alt

@enduml

@startuml

autoactivate on
autonumber

actor "Registered Customer" as User
participant ":ReviewController" as Ctrl
participant "service:VoteService" as Service2
participant "service:ReviewService" as Service
participant "repo:VoteRepository" as Repo2
participant "repo:ReviewRepository" as Repo
participant "Review" as Review


activate User

User -> Ctrl: asks to delete a review
Ctrl -> Service2: getVotesByReviewId(reviewId)
Service2 -> Repo2: getVotesByReviewId(reviewId)
Repo2 - -> Ctrl: number of votes
alt if no votes
Ctrl -> Service: withdrawReview()
Service -> Repo: deleteById(reviewId)
Repo - -> Repo: deleteByIdIfMatch()
else if there's votes
Service - -> Ctrl: ResponseStatusException()
Ctrl - -> User: Informs operation invalid
end alt

@enduml

PlantUML version 1.2022.1(Tue Feb 01 18:19:58 GMT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: pt
Country: PT
--></g></svg>